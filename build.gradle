plugins {
    id 'kotlin-multiplatform' version '1.3.50' apply false
    id "org.jetbrains.kotlin.jvm" version "1.3.50" apply false
    id 'org.jetbrains.gradle.plugin.idea-ext' version '0.5' apply false
    // executing node scripts (adds support for Yarn. Also - NPM, Grunt and Gulp)
    id 'com.moowork.node' version '1.3.1' apply false
    // publishing to bintray
    id "com.jfrog.bintray" version "1.8.4"
}


allprojects {
//    println "--- project ---: $project.name $project.depth ${if(project.depth > 0) project.parent.rootDir else ''}"
//    println "--- project ---: $project.name $project.rootDir"
}

def publishedProjects = [
        'base-portable',
        'base',
        'mapper-core',
        'vis-canvas',
        'vis-svg',
        'vis-svg-mapper',
        'vis-svg-mapper-jfx',
        'plot-base-portable',
        'plot-base',
        'plot-common-portable',
        'plot-common',
        'plot-builder-portable',
        'plot-builder',
        'plot-config-portable',
        'plot-config',
        'vis-demo-common',
        'vis-demo-common-jfx',
        'jvm-jfx-package',
]

subprojects {
    group 'org.jetbrains.datalore-plot'
    version = "1.0-SNAPSHOT"

    repositories {
        mavenCentral()
        jcenter()
    }

    tasks.all {
        if (name in ['compileKotlinJvm', 'compileTestKotlinJvm']) {
            kotlinOptions.jvmTarget = "1.8"

        }
//        if (name == 'compileKotlinJs') {
//        }
    }

    if (name in publishedProjects) {
        apply plugin: 'maven-publish'
        publishing {
            repositories {
                maven {
                    url = uri("$rootDir/.maven-publish-dev-repo")
                }
            }
        }
    }
}

if (hasProperty('bintray_user') && hasProperty('bintray_key')) {
    bintray {
        user = bintray_user
        key = bintray_key
    }
}