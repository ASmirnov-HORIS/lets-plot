// The workaround for this issue: https://github.com/Kotlin/kotlinx.serialization/issues/499
plugins {
    id 'kotlin-multiplatform' version '1.3.40' apply false
    id 'kotlinx-serialization' version '1.3.40' apply false
    id 'org.jetbrains.gradle.plugin.idea-ext' version '0.5' apply false
}


allprojects {
//    println "--- project ---: $project.name $project.depth ${if(project.depth > 0) project.parent.rootDir else ''}"
//    println "--- project ---: $project.name $project.rootDir"
}

subprojects {
    group 'org.jetbrains.datalore-plot'
    version = "1.0-SNAPSHOT"

    repositories {
        mavenCentral()
        jcenter()
    }

    tasks.all {
        if (name in ['compileKotlinJvm', 'compileTestKotlinJvm']) {
            kotlinOptions.jvmTarget = "1.8"

//            doFirst {
//                println "doFirst : $name in $project.name jvmTarget=$kotlinOptions.jvmTarget"
//            }
        }
        if (name == 'compileKotlinJs') {
//            doFirst {
//                println "doFirst : $name in $project.name jvmTarget=$kotlinOptions.jvmTarget"
//            }
//            doFirst {
//                println "doFirst : $name in $project.name"
//                println "kotlinOptions.sourceMap: ${kotlinOptions.sourceMap}"
//                println "kotlinOptions.sourceMapEmbedSources: ${kotlinOptions.sourceMapEmbedSources}"
//            }
//            doLast {
//                println "doLast : $name in $project.name"
//                println "kotlinOptions.sourceMap: ${kotlinOptions.sourceMap}"
//                println "kotlinOptions.sourceMapEmbedSources: ${kotlinOptions.sourceMapEmbedSources}"
//            }
        }
    }
}


