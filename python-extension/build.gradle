plugins {
    id 'kotlin-multiplatform'
    id 'org.jetbrains.gradle.plugin.idea-ext'
}

kotlin {
    if (project.properties['python_include_path'] != null) {
        macosX64() {
            binaries {
                staticLib {
                    baseName = "datalore-plot-${project.name}"
                }
            }

            compilations.main.cinterops {
                python {
                    compilerOpts "-I${project.properties['python_include_path']}"
                }
            }
        }

        linuxX64() {
            binaries {
                sharedLib {
                    baseName = "datalore-plot-${project.name}"
                }
            }

            compilations.main.cinterops {
                python {
                    compilerOpts "-I${project.properties['python_include_path']}"
                }
            }
        }
    } else {
        println("------------------------------------------------------------------------------------------------")
        println("Python package build unavailable. Please set \"python_include_path\" property in gradle.properties file.")
        println("------------------------------------------------------------------------------------------------")
    }


    sourceSets {
        commonMain {
            dependencies {
                implementation kotlin('stdlib-common')

                // (!) only `portable` sources
                implementation project(':base-portable')
                implementation project(':plot-config-portable')
            }
        }
    }
}